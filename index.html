<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Yxsimg : ">
    <meta http-equiv="Access-Control-Allow-Origin" content="*">

    <!--

    <script src="js/third/jquery.min.js"></script>
    <script src="js/third/hashes.min.js"></script>
    <script src="package/bootstrap/js/bootstrap.min.js"></script>
    <script src="js/third/pouchdb-3.2.0.min.js"></script>
    <script src="js/third/phaser.min.js"></script>
    
    <link href="package/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <link href="package/bootstrap/css/bootstrap-theme.min.css" rel="stylesheet" />
-->
    <script src="js/third/pixi.js"></script>

    <title>Yxsimg</title>
</head>

<body>
    <h1>5 chess</h1>

</body>
</html>

<script>

    var stage_width = 450;
    var stage_heigh = 400;

    var stage = new PIXI.Stage(0xFFFFFF);
    var renderer = PIXI.autoDetectRenderer(stage_width, stage_heigh);
    document.body.appendChild(renderer.view);
    requestAnimFrame(animate);

    stage.position.x = 100;
    stage.position.y = 300;
    stage.interactive = true;

    var texture = PIXI.Texture.fromImage("file/bunny.png");


    var graphics = new PIXI.Graphics();
    graphics.drawCircle(100, 100, 100);

    function createBunny(nowposition) {
        var bunny = new PIXI.Sprite(texture);

        bunny.anchor.x = 0.5;
        bunny.anchor.y = 0.5;
        bunny.position.x = nowposition.x;
        bunny.position.y = nowposition.y;
        bunny.width = 50;
        bunny.height = 50;
        bunny.interaction = true;
        bunny.buttonMode = true;
        bunny.defaultCursor = "pointer";
        bunny.rotation = bunny1 ? bunny1.rotation : 0;
        bunny.dir = 1;

        stage.addChild(bunny);

        bunny.mouseover = function (e) { bunny.alpha = 1; };
        bunny.mouseout = function (e) { bunny.alpha = 1; };

        return bunny;

    }

    var graphics = new PIXI.Graphics();
    stage.addChild(graphics);

    function createBoard(x, y, x_count, y_count, width) {

        
        boardcolor=0xD2B48C;
        linecolor=0x000000;

        // set a fill and line style
        graphics.beginFill(boardcolor, 1);
        graphics.lineStyle(1, linecolor, 1);
        graphics.moveTo(x - width , y - width);
        graphics.lineTo(x + width * (x_count+1) , y - width);
        graphics.lineTo(x + width * (x_count+1) , y + width * (y_count+1));
        graphics.lineTo(x - width , y + width * (y_count+1));
        graphics.lineTo(x - width , y - width);
        graphics.endFill(boardcolor, 1);

        // draw a shape

        for (var i = 0; i <= x_count; i++) {
            graphics.moveTo(x + width * i, y);
            graphics.lineTo(x + width * i, y + width * y_count);

           var txt=new PIXI.Text(String.fromCharCode("A".charCodeAt(0)+i),{font:'0.8px Arial',align:'right'});
           txt.position.x= x + width * i - width/6;
           txt.position.y= y - width/4*3;
           stage.addChild(txt);

        }

        for (var i = 0; i <= y_count; i++) {
            graphics.moveTo(x, y + width * i);
            graphics.lineTo(x + width * x_count, y + width * i);

           var txt=new PIXI.Text(i+1,{font:'0.8px Arial',align:'right'});
           txt.position.x=x-width/4*3;
           txt.position.y= y + width * i-width/3;
           stage.addChild(txt);

        }


        return { x: x, y: y, x_count: x_count, y_count: y_count, width: width };

    }

    var isblack = true;
    chessarr = [];
    function createChess(board, point) {

        var x_off = Math.round((point.x - board.x) / board.width);
        var y_off = Math.round((point.y - board.y) / board.width);

        if (x_off < 0 || x_off > board.x_count || y_off < 0 || y_off > board.y_count) {
            return;
        }

        var x = board.x + x_off * board.width;
        var y = board.y + y_off * board.width;


        if (!chessarr[x] || !chessarr[x][y]) {
            if (isblack) {
                color = 0x000000;
                isblack = false;
            }
            else {
                color = 0xFFFFFF;
                isblack = true;
            }
            graphics.beginFill(color, 1);
            graphics.drawCircle(x, y, board.width / 2);
            graphics.endFill();
            chessarr[x] = {};
            chessarr[x][y] = true;
        }

    }

    var board = createBoard(50, 50, 14, 14, 20);


    var bunny1 = createBunny({ x: 100, y: 300 });


    function myclick(e) {
        xarr[xarr.length] = createBunny(e.global);
    }

    stage.tap = function (e) {
        //myclick(e);
        createChess(board, e.global)
    }

    stage.mouseup = function (e) {
       // myclick(e);
        createChess(board, e.global)
    }


    var xarr = [bunny1];

    var dir = 1;
    var nowrotate = 0;
    function animate() {
        requestAnimFrame(animate);

        for (var i = 0; i < xarr.length; i++) {
            var bunny = xarr[i];
            bunny.rotation += 0.1;
            bunny.position.x += 4 * bunny.dir;
            if (bunny.position.x > stage_width) {
                bunny.dir = -1;
            }
            if (bunny.position.x < 0) {
                bunny.dir = 1;
            }
        }

        renderer.render(stage);

    }



</script>

