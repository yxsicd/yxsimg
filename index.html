<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Yxsimg : ">
    <meta http-equiv="Access-Control-Allow-Origin" content="*">
    <script src="js/third/jquery.min.js"></script>
    <script src="js/third/hashes.min.js"></script>
    <script src="package/bootstrap/js/bootstrap.min.js"></script>
    <script src="js/third/pouchdb-3.2.0.min.js"></script>
    <script src="js/third/phaser.min.js"></script>
    <script src="js/third/pixi.js"></script>
    <link href="package/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <link href="package/bootstrap/css/bootstrap-theme.min.css" rel="stylesheet" />

    <title>Yxsimg</title>
</head>

<body>
    <h1>test</h1>

</body>
</html>

<script>
    //var db = new PouchDB('aa');

    //for (var i = 0; i < 1; i++) {
    //    db.post({
    //        name: 'David',
    //        age: i
    //    });
    //}

    //db.changes().on('change', function () {
    //    //console.log('Ch-Ch-Changes');
    //});

    //db.allDocs({ include_docs: true, descending: true }, function (err, doc) { console.log(doc.rows); });

    var stage = new PIXI.Stage(0x888888);
    var renderer = PIXI.autoDetectRenderer(900, 600);
    document.body.appendChild(renderer.view);
    requestAnimFrame(animate);

    stage.position.x = 100;
    stage.position.y = 300;
    stage.interactive = true;

    var texture = PIXI.Texture.fromImage("file/bunny.png");


    function createBunny(nowposition) {
        var bunny = new PIXI.Sprite(texture);

        bunny.anchor.x = 0.5;
        bunny.anchor.y = 0.5;
        bunny.position.x = nowposition.x;
        bunny.position.y = nowposition.y;
        bunny.width = 50;
        bunny.height = 50;
        bunny.interaction = true;
        bunny.buttonMode = true;
        bunny.defaultCursor = "pointer";
        bunny.rotation = bunny1?bunny1.rotation:0;
        bunny.dir=1;

        stage.addChild(bunny);

        bunny.mouseover = function (e) { bunny.alpha = 1; };
        bunny.mouseout = function (e) { bunny.alpha = 1; };
        
        return bunny;

    }

    var bunny1 = createBunny({x:100,y:300});

    var begin_down = false;
    stage.mousedown = function (e) {
        //createBunny(stage.getMousePosition());
        begin_down = false;
    }

    stage.mouseup = function (e) {
        begin_down = true;
    }

    stage.tap = function (e) {
        begin_down = true;
    }

    var xarr = [bunny1];

    var dir = 1;
    var nowrotate = 0;
    function animate() {
        requestAnimFrame(animate);

        for (var i = 0; i < xarr.length; i++) {
            var bunny = xarr[i];
            bunny.rotation += 0.1;
            bunny.position.x += 4 * bunny.dir;
            if (bunny.position.x > 900) {
                bunny.dir = -1;
            }
            if (bunny.position.x < 0) {
                bunny.dir = 1;
            }
        }

        if (begin_down) {
            begin_down = false;
            xarr[xarr.length] = createBunny(stage.getMousePosition());
        }
        renderer.render(stage);

    }



</script>

